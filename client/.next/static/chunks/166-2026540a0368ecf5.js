"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[166],{1849:(e,a,o)=>{o.d(a,{A:()=>r});let r=(0,o(7982).A)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]])},2196:(e,a,o)=>{o.d(a,{A:()=>r});let r=(0,o(7982).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},2262:(e,a,o)=>{o.d(a,{A:()=>r});let r=(0,o(7982).A)("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},3333:(e,a,o)=>{o.d(a,{A:()=>t});var r=o(3365);let t=e=>{let{variant:a="primary",icon:o,children:t,className:s,...n}=e;return(0,r.jsxs)("button",{className:"".concat("px-4 py-3 rounded-lg flex items-center justify-center font-medium transition-all duration-200 min-h-[44px]"," ").concat({primary:"text-white hover:opacity-90 shadow-md hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",secondary:"bg-gray-100 text-gray-800 hover:bg-gray-200 border border-gray-300"}[a]," ").concat(s||""),style:"primary"===a?{backgroundColor:"#FF6B00"}:void 0,...n,children:[o&&(0,r.jsx)(o,{size:18,className:"mr-2"}),t]})}},5166:(e,a,o)=>{o.d(a,{A:()=>u});var r=o(3365),t=o(1521),s=o(2262);let n=(0,o(7982).A)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);var l=o(2196),i=o(1849),c=o(3333),d=o(7043);function u(e){let{isOpen:a,onClose:o,onLogoAdded:u}=e,[m,p]=(0,t.useState)(null),[g,b]=(0,t.useState)(""),[h,x]=(0,t.useState)(""),[f,v]=(0,t.useState)(!1),[y,j]=(0,t.useState)(!1),N=g&&!f,k=m&&g&&!f,w=e=>["image/svg+xml","image/png","image/jpeg","image/jpg","application/pdf"].includes(e.type)?e.size>0xa00000?void alert("Arquivo muito grande. O tamanho m\xe1ximo \xe9 10MB."):void(console.log("\uD83D\uDCC1 Arquivo selecionado:",e.name),p(e)):void alert("Tipo de arquivo n\xe3o permitido. Use SVG, PNG, JPG ou PDF."),E=async()=>{if(m&&g){v(!0);try{console.log("\uD83D\uDE80 Iniciando upload...",{file:m.name,version:g});let e=await (0,d.ih)(m,g);if(!e.success){let a="error"in e?e.error:"Dados inv\xe1lidos";a.includes("Bucket n\xe3o existe")?alert("❌ Erro de configura\xe7\xe3o do storage!\n\n\uD83D\uDD27 SOLU\xc7\xc3O:\n1. O bucket precisa ser criado no painel do Supabase\n2. Consulte o arquivo SOLUCAO_UPLOAD_LOGO.md\n3. Ou execute: npm run setup-storage\n\nErro: ".concat(a)):a.includes("permiss\xe3o")||a.includes("row-level security")?alert("❌ Erro de permiss\xe3o!\n\n\uD83D\uDD27 POSS\xcdVEIS CAUSAS:\n1. Voc\xea precisa estar logado na aplica\xe7\xe3o\n2. O storage n\xe3o est\xe1 configurado corretamente\n3. Pol\xedticas de seguran\xe7a n\xe3o foram aplicadas\n\nConsulte SOLUCAO_UPLOAD_LOGO.md para detalhes.\n\nErro: ".concat(a)):alert("❌ Erro no upload: ".concat(a,"\n\n\uD83D\uDCA1 Se o problema persistir, consulte SOLUCAO_UPLOAD_LOGO.md"));return}if(!("data"in e)||!e.data)return void alert("❌ Erro: Dados de upload inv\xe1lidos");console.log("✅ Upload conclu\xeddo com sucesso!",e.data);let a={version:g,file_url:e.data.file_url,file_name:e.data.file_name,format:e.data.format,uploaded_at:new Date().toISOString(),size_bytes:e.data.size_bytes,application_notes:h||void 0,storage_path:e.data.storage_path};console.log("\uD83C\uDF89 Adicionando logo \xe0 lista...",a),u(a),p(null),b(""),x(""),o()}catch(a){console.error("\uD83D\uDCA5 Erro inesperado no upload:",a);let e=a instanceof Error?a.message:"Erro desconhecido";alert("❌ Erro inesperado durante o upload.\n\nDetalhes: ".concat(e,"\n\n\uD83D\uDCA1 Verifique:\n1. Se voc\xea est\xe1 logado na aplica\xe7\xe3o\n2. Se o storage est\xe1 configurado (SOLUCAO_UPLOAD_LOGO.md)\n3. Se o arquivo \xe9 v\xe1lido\n\nTente novamente ou consulte a documenta\xe7\xe3o."))}finally{v(!1)}}},D=e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?j(!0):"dragleave"===e.type&&j(!1)};return a?(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Adicionar Logotipo"}),(0,r.jsx)("button",{onClick:o,disabled:f,className:"text-gray-400 hover:text-gray-600 disabled:opacity-50",children:(0,r.jsx)(l.A,{className:"w-6 h-6"})})]}),(0,r.jsxs)("div",{className:"p-6 space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Vers\xe3o do Logo *"}),(0,r.jsxs)("select",{value:g,onChange:e=>b(e.target.value),disabled:f,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50",children:[(0,r.jsx)("option",{value:"",children:"Selecione uma vers\xe3o..."}),[{value:"principal_colorida",label:"Principal Colorida"},{value:"monocromatica_preta",label:"Monocrom\xe1tica Preta"},{value:"monocromatica_branca",label:"Monocrom\xe1tica Branca"},{value:"escala_cinza",label:"Escala de Cinza"}].map(e=>(0,r.jsx)("option",{value:e.value,children:e.label},e.value))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Arquivo do Logo *"}),m?(0,r.jsxs)("div",{className:"border border-gray-300 rounded-lg p-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(()=>{var e;let a="pdf"===(null==(e=m.name.split(".").pop())?void 0:e.toLowerCase())?s.A:n;return(0,r.jsx)(a,{className:"w-8 h-8 text-blue-500"})})(),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:m.name}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:(e=>{if(0===e)return"0 Bytes";let a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(1))+" "+["Bytes","KB","MB"][a]})(m.size)})]}),(0,r.jsx)("button",{onClick:()=>{p(null)},disabled:f,className:"text-gray-400 hover:text-gray-600 disabled:opacity-50",children:(0,r.jsx)(l.A,{className:"w-5 h-5"})})]}),(0,r.jsx)("button",{onClick:()=>{var e;return null==(e=document.getElementById("file-input"))?void 0:e.click()},disabled:f,className:"mt-3 text-sm text-blue-600 hover:text-blue-700 disabled:opacity-50",children:"Selecionar outro arquivo"})]}):(0,r.jsxs)("div",{className:"relative border-2 border-dashed rounded-lg p-6 text-center transition-colors ".concat(y?"border-blue-400 bg-blue-50":N?"border-gray-300 hover:border-gray-400":"border-gray-200 bg-gray-50"),onDragEnter:D,onDragLeave:D,onDragOver:D,onDrop:e=>{var a;if(e.preventDefault(),e.stopPropagation(),j(!1),!N)return;let o=null==(a=e.dataTransfer.files)?void 0:a[0];o&&w(o)},children:[(0,r.jsx)(i.A,{className:"w-8 h-8 mx-auto mb-3 ".concat(N?"text-gray-400":"text-gray-300")}),(0,r.jsx)("p",{className:"text-sm ".concat(N?"text-gray-600":"text-gray-400"),children:N?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"font-medium",children:"Clique para selecionar"})," ou arraste o arquivo aqui"]}):"Selecione uma vers\xe3o primeiro"}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"SVG, PNG, JPG ou PDF at\xe9 10MB"}),(0,r.jsx)("input",{id:"file-input",type:"file",accept:".svg,.png,.jpg,.jpeg,.pdf",onChange:e=>{var a;let o=null==(a=e.target.files)?void 0:a[0];o&&w(o)},disabled:!N,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer disabled:cursor-not-allowed"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notas de Aplica\xe7\xe3o (opcional)"}),(0,r.jsx)("textarea",{value:h,onChange:e=>x(e.target.value),disabled:f,placeholder:"Ex: Use apenas em fundos claros, mantenha propor\xe7\xe3o...",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-end gap-3 p-6 border-t border-gray-200",children:[(0,r.jsx)(c.A,{onClick:o,variant:"secondary",disabled:f,children:"Cancelar"}),(0,r.jsx)(c.A,{onClick:E,disabled:!k,children:f?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Fazendo Upload..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.A,{className:"w-4 h-4 mr-2"}),"Fazer Upload"]})})]})]})}):null}},7043:(e,a,o)=>{o.d(a,{F_:()=>n,ih:()=>s});var r=o(846);async function t(){try{let{data:e,error:a}=await r.N.storage.from("brand-assets").list("",{limit:1});if(!a)return console.log("✅ Bucket brand-assets est\xe1 dispon\xedvel"),!0;console.log("⚠️  Bucket brand-assets n\xe3o encontrado");let{data:o,error:t}=await r.N.storage.listBuckets();if(t)throw console.error("❌ Erro ao acessar storage:",t.message),Error("Erro de acesso ao storage: ".concat(t.message));if(!(null==o?void 0:o.some(e=>"brand-assets"===e.id))){console.log("\uD83D\uDD27 Tentando criar bucket brand-assets...");let{error:e}=await r.N.storage.createBucket("brand-assets",{public:!0,allowedMimeTypes:["image/png","image/jpeg","image/svg+xml","application/pdf"],fileSizeLimit:0xa00000});if(e)throw console.error("❌ Erro ao criar bucket:",e.message),Error('Bucket n\xe3o existe e n\xe3o foi poss\xedvel criar automaticamente. \n        \n\uD83D\uDD27 SOLU\xc7\xc3O MANUAL:\n1. Acesse o painel do Supabase: https://supabase.com/dashboard\n2. V\xe1 em Storage > Buckets\n3. Clique em "New bucket"\n4. Nome: brand-assets\n5. Marque como "Public bucket"\n6. Confirme e tente novamente\n\nErro t\xe9cnico: '.concat(e.message));console.log("✅ Bucket brand-assets criado com sucesso")}return!0}catch(e){throw console.error("❌ Erro na configura\xe7\xe3o do bucket:",e),e instanceof Error?e:Error("Erro desconhecido na configura\xe7\xe3o do storage")}}async function s(e,a){try{console.log("\uD83D\uDE80 Iniciando upload do logo...",{fileName:e.name,version:a}),console.log("\uD83D\uDCE6 Verificando bucket..."),await t();let o=Date.now(),s=e.name.split(".").pop(),n="".concat(a,"_").concat(o,".").concat(s),l="brand-manuals/logos/".concat(n);console.log("⬆️  Fazendo upload...",{filePath:l});let{data:i,error:c}=await r.N.storage.from("brand-assets").upload(l,e,{cacheControl:"3600",upsert:!1});if(c){if(console.error("❌ Erro no upload:",c),c.message.includes("new row violates row-level security policy"))throw Error("Erro de permiss\xe3o no storage. \n        \n\uD83D\uDD27 POSS\xcdVEIS SOLU\xc7\xd5ES:\n1. Fa\xe7a login no sistema antes de fazer upload\n2. Verifique se o bucket est\xe1 configurado corretamente\n3. Execute o SQL de configura\xe7\xe3o: sql/storage_setup.sql\n\nErro t\xe9cnico: ".concat(c.message));if(c.message.includes("The bucket does not exist"))throw Error('Bucket de storage n\xe3o existe.\n        \n\uD83D\uDD27 SOLU\xc7\xc3O:\n1. Acesse https://supabase.com/dashboard\n2. V\xe1 em Storage > Buckets  \n3. Crie um bucket chamado "brand-assets"\n4. Marque como p\xfablico\n5. Tente novamente\n\nErro t\xe9cnico: '.concat(c.message));throw Error("Erro no upload: ".concat(c.message))}console.log("✅ Upload conclu\xeddo!",i);let{data:d}=r.N.storage.from("brand-assets").getPublicUrl(l),u={success:!0,data:{file_url:d.publicUrl,storage_path:l,file_name:e.name,format:(null==s?void 0:s.toUpperCase())||"UNKNOWN",size_bytes:e.size}};return console.log("\uD83C\uDF89 Upload finalizado com sucesso!",u),u}catch(e){return console.error("\uD83D\uDCA5 Erro no upload:",e),{success:!1,error:e instanceof Error?e.message:"Erro desconhecido no upload"}}}async function n(e){try{let{error:a}=await r.N.storage.from("brand-assets").remove([e]);if(a)throw a;return{success:!0}}catch(e){return console.error("Erro ao remover arquivo:",e),{success:!1,error:e instanceof Error?e.message:"Erro desconhecido"}}}}}]);