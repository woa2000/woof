(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{627:(e,r,s)=>{"use strict";var t=s(7192);s.o(t,"usePathname")&&s.d(r,{usePathname:function(){return t.usePathname}}),s.o(t,"useRouter")&&s.d(r,{useRouter:function(){return t.useRouter}})},846:(e,r,s)=>{"use strict";s.d(r,{N:()=>t});let t=(0,s(7990).UU)("https://scbwseltwscuplhnmcyu.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNjYndzZWx0d3NjdXBsaG5tY3l1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTMyODQ1MTYsImV4cCI6MjA2ODg2MDUxNn0.VgC2Oxx0-fjT2B4MljwxH_FUukBAP7TDGP4b50i-PEk",{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}})},1098:(e,r,s)=>{Promise.resolve().then(s.bind(s,7944))},3033:(e,r,s)=>{"use strict";s.d(r,{A:()=>l});var t=s(1521),a=s(846),o=s(8912);let n=e=>{var r,s,t;return{id:e.id,email:e.email,name:(null==(r=e.user_metadata)?void 0:r.full_name)||(null==(s=e.user_metadata)?void 0:s.name),avatar:null==(t=e.user_metadata)?void 0:t.avatar_url}},l=()=>{let[e,r]=(0,t.useState)({user:null,loading:!0,error:null});(0,t.useEffect)(()=>{(async()=>{try{let{data:{session:e},error:s}=await a.N.auth.getSession();if(s){console.error("Erro ao verificar sess\xe3o:",s),r({user:null,loading:!1,error:s.message});return}(null==e?void 0:e.user)?r({user:n(e.user),loading:!1,error:null}):r(e=>({...e,loading:!1}))}catch(e){console.error("Erro ao verificar sess\xe3o:",e),r({user:null,loading:!1,error:"Erro ao verificar sess\xe3o"})}})();let{data:{subscription:e}}=a.N.auth.onAuthStateChange(async(e,s)=>{if(o.s.log("Auth state changed:",{event:e,session:s?"exists":"null"}),"SIGNED_IN"===e&&(null==s?void 0:s.user)){let e=n(s.user);r({user:e,loading:!1,error:null}),o.s.logUserState(!0,!1,e)}else if("SIGNED_OUT"===e)r({user:null,loading:!1,error:null}),o.s.logUserState(!1,!1,null);else if("TOKEN_REFRESHED"===e&&(null==s?void 0:s.user)){let e=n(s.user);r(r=>({...r,user:e,loading:!1}))}else s||r(e=>({user:null,loading:!1,error:null}))});return()=>{e.unsubscribe()}},[]);let s=async(e,s)=>{r(e=>({...e,loading:!0,error:null}));try{let{data:t,error:l}=await a.N.auth.signInWithPassword({email:e,password:s});if(l)return r({user:null,loading:!1,error:l.message}),{success:!1,error:l.message};if(t.user&&t.session){o.s.log("Login successful, updating state immediately");let e=n(t.user);return r({user:e,loading:!1,error:null}),{success:!0,user:e}}return r(e=>({...e,loading:!1})),{success:!1,error:"Dados de autentica\xe7\xe3o inv\xe1lidos"}}catch(s){let e=s instanceof Error?s.message:"Erro ao fazer login";return r({user:null,loading:!1,error:e}),{success:!1,error:e}}},l=async e=>{try{let{data:s,error:t}=await a.N.auth.signInWithOAuth({provider:e,options:{redirectTo:"".concat(window.location.origin,"/dashboard")}});if(t){let s=t.message||"Erro ao fazer login com ".concat(e);return r(e=>({...e,error:s})),{success:!1,error:s}}return{success:!0}}catch(t){let s=t instanceof Error?t.message:"Erro ao fazer login com ".concat(e);return r(e=>({...e,error:s})),{success:!1,error:s}}},u=async()=>{try{let{error:e}=await a.N.auth.signOut();if(e){let s=e.message||"Erro ao fazer logout";return r(e=>({...e,error:s})),{success:!1,error:s}}return r({user:null,loading:!1,error:null}),{success:!0}}catch(s){let e=s instanceof Error?s.message:"Erro ao fazer logout";return r(r=>({...r,error:e})),{success:!1,error:e}}};return{...e,signIn:s,signInWithProvider:l,signOut:u,isAuthenticated:!!e.user}}},7944:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>l});var t=s(3365),a=s(1521),o=s(627),n=s(3033);let l=()=>{let e=(0,o.useRouter)(),{isAuthenticated:r,loading:s}=(0,n.A)();return((0,a.useEffect)(()=>{s||(r?e.replace("/dashboard"):e.replace("/login"))},[r,s,e]),s)?(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-woof-orange"})}):null}},8912:(e,r,s)=>{"use strict";s.d(r,{s:()=>t});let t={log:(e,r)=>{},logUserState:(e,r,s)=>{},logRedirect:(e,r,s)=>{}}}},e=>{e.O(0,[990,347,508,358],()=>e(e.s=1098)),_N_E=e.O()}]);